'''
Created on May 31, 2017

@author: anton

Tests for Generated Datasets
'''
from DataSet import DataSet
from tests_common import test_unit_mlp, test_block_mlp, test_unit_RBF

# rej, clf, noisi_size, units, beta, dropout, es, targets, epochs

params_0 = [
    
    ['mlp-sgm',  3, 0.0,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm',  6, 0.0,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 12, 0.0,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 12, 0.0,  1.0, 10, (0.0, 1.0), 5000],
    ['mlp-sgm', 12, 1e-3, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 12, 1e-4, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 12, 1e-5, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 12, 1e-4, 1.0, 0,  (0.1, 0.9), 5000],
    ['mlp-sgm', 12, 1e-4, 1.0, 10, (0.0, 1.0), 5000],
    ['mlp-sgm', 12, 1e-4, 0.9, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 12, 1e-4, 0.9, 10, (0.0, 1.0), 5000],
    
    ['mlp-sft',  3, 0.0,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sft',  6, 0.0,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sft', 12, 0.0,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sft', 12, 0.0,  1.0, 10, (0.0, 1.0), 5000],
    ['mlp-sft', 12, 1e-3, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sft', 12, 1e-4, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sft', 12, 1e-5, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sft', 12, 1e-4, 1.0, 0,  (0.1, 0.9), 5000],
    ['mlp-sft', 12, 1e-4, 1.0, 10, (0.0, 1.0), 5000],
    ['mlp-sft', 12, 1e-4, 0.9, 0,  (0.0, 1.0), 5000],
    ['mlp-sft', 12, 1e-4, 0.9, 10, (0.0, 1.0), 5000],
    
    ['rbf',  3, 0.0,  1.0, 0,  (0.0, 1.0), 5000],
    ['rbf',  6, 0.0,  1.0, 0,  (0.0, 1.0), 5000],
    ['rbf', 12, 0.0,  1.0, 0,  (0.0, 1.0), 5000],
    ['rbf', 12, 0.0,  1.0, 10, (0.0, 1.0), 5000],
    ['rbf', 12, 1e-3, 1.0, 0,  (0.0, 1.0), 5000],
    ['rbf', 12, 1e-4, 1.0, 0,  (0.0, 1.0), 5000],
    ['rbf', 12, 1e-5, 1.0, 0,  (0.0, 1.0), 5000],
    ['rbf', 12, 1e-4, 1.0, 0,  (0.1, 0.9), 5000],
    ['rbf', 12, 1e-4, 1.0, 10, (0.0, 1.0), 5000],
    ['rbf', 12, 1e-4, 0.9, 0,  (0.0, 1.0), 5000],
    ['rbf', 12, 1e-4, 0.9, 10, (0.0, 1.0), 5000],
    
    ['rbf-reg',  3, 0.0,  1.0, 0,  (0.0, 1.0), 5000],
    ['rbf-reg',  6, 0.0,  1.0, 0,  (0.0, 1.0), 5000],
    ['rbf-reg', 12, 0.0,  1.0, 0,  (0.0, 1.0), 5000],
    ['rbf-reg', 12, 0.0,  1.0, 10, (0.0, 1.0), 5000],
    ['rbf-reg', 12, 1e-3, 1.0, 0,  (0.0, 1.0), 5000],
    ['rbf-reg', 12, 1e-4, 1.0, 0,  (0.0, 1.0), 5000],
    ['rbf-reg', 12, 1e-5, 1.0, 0,  (0.0, 1.0), 5000],
    ['rbf-reg', 12, 1e-4, 1.0, 0,  (0.1, 0.9), 5000],
    ['rbf-reg', 12, 1e-4, 1.0, 10, (0.0, 1.0), 5000],
    ['rbf-reg', 12, 1e-4, 0.9, 0,  (0.0, 1.0), 5000],
    ['rbf-reg', 12, 1e-4, 0.9, 10, (0.0, 1.0), 5000]
    
    ]

params_1 = [
    ['mlp-sgm', 12, 0.0,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 32, 0.0,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 32, 0.0,  1.0, 10, (0.0, 1.0), 5000],
    ['mlp-sgm', 32, 1e-3, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 32, 1e-4, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 32, 1e-5, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 32, 1e-4, 1.0, 0,  (0.1, 0.9), 5000],
    ['mlp-sgm', 32, 1e-4, 1.0, 10, (0.0, 1.0), 5000],
    ['mlp-sgm', 32, 1e-4, 0.9, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 32, 1e-4, 0.6, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 32, 1e-4, 0.9, 10, (0.0, 1.0), 5000]
    ]

params_2 = [
    ['mlp-sgm', 12, 0.0,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 32, 0.0,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 32, 0.0,  1.0, 10, (0.0, 1.0), 5000],
    ['mlp-sgm', 32, 1e-3, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 32, 1e-4, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 32, 1e-5, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 32, 1e-4, 1.0, 0,  (0.1, 0.9), 5000],
    ['mlp-sgm', 32, 1e-4, 1.0, 10, (0.0, 1.0), 5000],
    ['mlp-sgm', 32, 1e-4, 0.9, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 32, 1e-4, 0.6, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 32, 1e-4, 0.9, 10, (0.0, 1.0), 5000],
    
    ['mlp-sft', 12, 0.0,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sft', 32, 0.0,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sft', 32, 0.0,  1.0, 10, (0.0, 1.0), 5000],
    ['mlp-sft', 32, 1e-3, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sft', 32, 1e-4, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sft', 32, 1e-5, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sft', 32, 1e-4, 1.0, 0,  (0.1, 0.9), 5000],
    ['mlp-sft', 32, 1e-4, 1.0, 10, (0.0, 1.0), 5000],
    ['mlp-sft', 32, 1e-4, 0.9, 0,  (0.0, 1.0), 5000],
    ['mlp-sft', 32, 1e-4, 0.6, 0,  (0.0, 1.0), 5000],
    ['mlp-sft', 32, 1e-4, 0.9, 10, (0.0, 1.0), 5000]
    ]

params_3 = [
    ['rbf', 16, 1e-3, 1.0, 0,  (0.0, 1.0), 5000],
    ['rbf', 16, 1e-4, 1.0, 0,  (0.0, 1.0), 5000],
    ['rbf', 16, 1e-5, 1.0, 0,  (0.0, 1.0), 5000],
    ['rbf', 16, 1e-6, 1.0, 0,  (0.0, 1.0), 5000],
    
    ['rbf-reg', 16, 1e-3, 1.0, 0,  (0.0, 1.0), 5000],
    ['rbf-reg', 16, 1e-4, 1.0, 0,  (0.0, 1.0), 5000],
    ['rbf-reg', 16, 1e-5, 1.0, 0,  (0.0, 1.0), 5000],
    ['rbf-reg', 16, 1e-6, 1.0, 0,  (0.0, 1.0), 5000],
    ]

if __name__ == '__main__':
    #  misclassifications
    
    #ds = DataSet(ds_id=5, size=1000, split=[0.1, 0.1, 0.8], add_noise=0)
    #test_unit_mlp(ds=ds, clf='mlp-sft', rej=0, units=12,
    #              beta=0.0001, dropout=1.0, es=0, targets=(0.0, 1.0),
    #              n_epochs=5000, show=True)
    
    #ds = DataSet(ds_id=9, size=1000, split=[0.1, 0.1, 0.8], add_noise=0,
    #             random_state=47)
    #test_unit_mlp(ds=ds, clf='mlp-sgm', rej=0, units=12,
    #              beta=0.0001, dropout=1.0, es=0, targets=(0.0, 1.0),
    #              n_epochs=5000, show=True)
    
    ds = DataSet(ds_id=9, size=1000, split=[0.1, 0.1, 0.8], add_noise=1,
                 random_state=47)
    test_unit_mlp(ds=ds, clf='mlp-sgm', rej=1, units=16,
                  beta=0.0001, dropout=1.0, es=0, targets=(0.0, 1.0),
                  n_epochs=5000, show=True)
    
    #ds = DataSet(ds_id=12, size=1000, split=[0.1, 0.1, 0.8], add_noise=3)
    #test_unit_RBF(ds, 16, 0.0001, True)
    
    # outliers
    
    #ds = DataSet(ds_id=12, size=1000, split=[0.1, 0.1, 0.8], add_noise=2,
    #             random_state=47)
    #test_unit_mlp(ds=ds, clf='mlp-sgm', rej=2, units=32,
    #              beta=0.0001, dropout=1.0, es=0, targets=(0.0, 1.0),
    #              n_epochs=5000, show=True)
    
    # blocks
    #test_block_mlp(5, 'moons_overlapping', 0, range(0,1), 1000, [0.1, 0.1, 0.8], params_0)
    #test_block_mlp(9, 'multiclass', 0, range(0,1), 1000, [0.1, 0.1, 0.8], params_0)
    # ----
    #test_block_mlp(12, 'moons_separable', 1, range(0,1), 1000, [0.1, 0.1, 0.8], params_1)
    #test_block_mlp(12, 'moons_separable', 2, range(0,1), 1000, [0.1, 0.1, 0.8], params_2)
    #test_block_mlp(12, 'moons_separable', 3, range(0,1), 1000, [0.1, 0.1, 0.8], params_3)
