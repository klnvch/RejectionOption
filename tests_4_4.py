'''
Created on Jun 24, 2017

@author: anton

Tests for Alphanumeric Dataset
'''
import pandas as pd
from scipy.stats import ranksums
from DataSet import DataSet
from tests_common import test_unit_mlp

# rej, clf, noisi_size, units, beta, dropout, es, targets, epochs
params_0 = [
    ['mlp-sgm', 16,  0.00001,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 32,  0.00001,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 64,  0.00001,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 128, 0.00001,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 256, 0.00001,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 128, 0.0001,   1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 128, 0.000001, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 128, 0.00001,  0.8, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 128, 0.00001,  0.5, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 128, 0.00001,  0.5, 10, (0.0, 1.0), 5000],
    ['mlp-sgm', 128, 0.00001,  0.5, 0,  (0.1, 0.9), 5000],
    
    ['mlp-sft', 16,  0.00001,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sft', 32,  0.00001,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sft', 64,  0.00001,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sft', 128, 0.00001,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sft', 256, 0.00001,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sft', 128, 0.0001,   1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sft', 128, 0.000001, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sft', 128, 0.00001,  0.8, 0,  (0.0, 1.0), 5000],
    ['mlp-sft', 128, 0.00001,  0.5, 0,  (0.0, 1.0), 5000],
    ['mlp-sft', 128, 0.00001,  0.5, 10, (0.0, 1.0), 5000]
    ]

params_1 = [
    ['mlp-sgm', 16,  0.00001,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 32,  0.00001,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 64,  0.00001,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 128, 0.00001,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 256, 0.00001,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 128, 0.0001,   1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 128, 0.000001, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 128, 0.00001,  0.8, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 128, 0.00001,  0.5, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 128, 0.00001,  0.5, 10, (0.0, 1.0), 5000],
    ['mlp-sgm', 128, 0.00001,  0.5, 0,  (0.1, 0.9), 5000],
    ]

params_2 = [
    ['mlp-sgm', 64, 0.00001,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 64, 0.00001,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 64, 0.00001,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 64, 0.00001,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 64, 0.00001,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm',  8, 0.00001,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 16, 0.00001,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 32, 0.00001,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 128, 0.00001,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 64, 0.0001,   1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 64, 0.000001, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 64, 0.00001,  0.8, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 64, 0.00001,  0.9, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 64, 0.00001,  1.0, 50, (0.0, 1.0), 5000],
    
    ['mlp-sft', 64, 0.00001,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sft', 64, 0.00001,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sft', 64, 0.00001,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sft', 64, 0.00001,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sft', 64, 0.00001,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sft',  8, 0.00001,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sft', 16, 0.00001,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sft', 32, 0.00001,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sft', 128, 0.00001,  1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sft', 64, 0.0001,   1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sft', 64, 0.000001, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sft', 64, 0.00001,  0.8, 0,  (0.0, 1.0), 5000],
    ['mlp-sft', 64, 0.00001,  0.9, 0,  (0.0, 1.0), 5000],
    ['mlp-sft', 64, 0.00001,  1.0, 50, (0.0, 1.0), 5000],
    ]

params_4 = [
    [0.000001, 32],
    [0.000001, 64],
    [0.000001, 128],
    [0.000001, 256],
    [0.000001, 512],
    
    [0.00001, 32],
    [0.00001, 64],
    [0.00001, 128],
    [0.00001, 256],
    [0.00001, 512],
    
    [0.0001, 32],
    [0.0001, 64],
    [0.0001, 128],
    [0.0001, 256],
    [0.0001, 512],
    
    [0.001, 32],
    [0.001, 64],
    [0.001, 128],
    [0.001, 256],
    [0.001, 512],
    
    [0.01, 32],
    [0.01, 64],
    [0.01, 128],
    [0.01, 256],
    [0.01, 512]
    ]

def wicoxon_test(filename, params):
    df = pd.read_csv(filename)
    print(df.keys())

    mrt = [df.loc[(
        (df['Clf'] == param[1])
        & (df['Units']   == param[3])
        & (df['Beta']    == param[4])
        & (df['Dropout'] == param[5])
        & (df['ES']      == param[6])
        & (df['Targets'] == str(param[7]))
        ), 'MDT'].values for param in params]
    
    print(mrt)
    
    A = [[ranksums(a, b).statistic for a in mrt] for b in mrt]
    
    print('\n'.join([','.join(['{:4f} '.format(item) for item in row]) for row in A]))

if __name__ == '__main__':
    #wicoxon_test('tests/alphanumeric/run_0.csv', params_0)
    #wicoxon_test('tests/alphanumeric/run_1.csv', params_1)
    
    #ds = DataSet(13, add_noise=0)#, output=(0.1, 0.9))
    #test_unit_mlp(ds, 'mlp-sigmoid', 0, None, 128, 0.00001, 0.5, 0, (0.0, 1.0), 5000, True)
    
    #ds = DataSet(13, add_noise=3)
    #test_unit_mlp(ds, 'rbf', 0, None, 128, 0.0, 1.0, 0, (0.0, 1.0), 5000, True)
    
    ds = DataSet(13, add_noise=3)
    test_unit_mlp(ds, 'rbf-reg', 0, None, 128, 0.0, 1.0, 0, (0.0, 1.0), 5000, True)
    
    #ds = DataSet(13, add_noise=3)
    #test_unit_RBF(ds, 128, 0.0001, True)
    
    #test_block_mlp(13, 'alphanumeric', 0, range(1,9), params_0)
    #test_block_mlp(13, 'alphanumeric', 1, range(9,10), params_1)
    #test_block_mlp(13, 'alphanumeric', 2, range(0,1), params_2)
    #test_block_rbf('alphanumeric', 13, range(0,1), params_4)