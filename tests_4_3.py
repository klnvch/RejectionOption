'''
Created on Jun 24, 2017

@author: anton

Tests for Image Segmentation Dataset
'''
from DataSet import DataSet
from tests_common import test_unit_mlp, test_block_mlp, test_block_rbf,\
    test_unit_RBF

params_0 = [
    ['mlp-sgm', 16, 1e-3, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 16, 1e-4, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 16, 1e-5, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 16, 1e-6, 1.0, 0,  (0.0, 1.0), 5000],
    
    ['mlp-sgm', 32, 1e-3, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 32, 1e-4, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 32, 1e-5, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 32, 1e-6, 1.0, 0,  (0.0, 1.0), 5000],
    
    ['mlp-sgm', 64, 1e-3, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 64, 1e-4, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 64, 1e-5, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 64, 1e-6, 1.0, 0,  (0.0, 1.0), 5000],
    
    ['mlp-sgm', 128, 1e-3, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 128, 1e-4, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 128, 1e-5, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 128, 1e-6, 1.0, 0,  (0.0, 1.0), 5000]
    ]

params_1 = [
    ['mlp-sgm', 64, 1e-4, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 64, 1e-5, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 64, 1e-6, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 64, 1e-5, 1.0, 10, (0.0, 1.0), 5000],
    ['mlp-sgm', 64, 1e-5, 0.8, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 64, 1e-5, 0.8, 10, (0.0, 1.0), 5000],
    
    ['mlp-sft', 64, 1e-4, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sft', 64, 1e-5, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sft', 64, 1e-6, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sft', 64, 1e-5, 1.0, 10, (0.0, 1.0), 5000],
    ['mlp-sft', 64, 1e-5, 0.8, 0,  (0.0, 1.0), 5000],
    ['mlp-sft', 64, 1e-5, 0.8, 10, (0.0, 1.0), 5000],
    
    ['rbf', 64, 1e-4, 1.0, 0,  (0.0, 1.0), 500],
    ['rbf', 64, 1e-5, 1.0, 0,  (0.0, 1.0), 500],
    ['rbf', 64, 1e-6, 1.0, 0,  (0.0, 1.0), 500],
    
    ['rbf-reg', 64, 1e-4, 1.0, 0,  (0.0, 1.0), 500],
    ['rbf-reg', 64, 1e-5, 1.0, 0,  (0.0, 1.0), 500],
    ['rbf-reg', 64, 1e-6, 1.0, 0,  (0.0, 1.0), 500]
    ]

params_2 = [
    ['rbf', 64, 1e-4, 1.0, 0,  (0.0, 1.0), 500],
    ['rbf', 64, 1e-5, 1.0, 0,  (0.0, 1.0), 500],
    ['rbf', 64, 1e-6, 1.0, 0,  (0.0, 1.0), 500],
    ['rbf', 64, 1e-7, 1.0, 0,  (0.0, 1.0), 500],
    
    ['rbf-reg', 64, 1e-4, 1.0, 0,  (0.0, 1.0), 500],
    ['rbf-reg', 64, 1e-5, 1.0, 0,  (0.0, 1.0), 500],
    ['rbf-reg', 64, 1e-6, 1.0, 0,  (0.0, 1.0), 500],
    ['rbf-reg', 64, 1e-7, 1.0, 0,  (0.0, 1.0), 500]
    ]

params_3 = [
    [1, 32],
    [1, 64],
    [1, 128],
    [1, 256],
    ]

params_4 = [
    ['mlp-sgm', 128, 1e-5, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 128, 1e-5, 1.0, 10, (0.0, 1.0), 5000],
    ['mlp-sgm', 128, 1e-5, 0.8, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 128, 1e-5, 0.8, 10, (0.0, 1.0), 5000],
    
    ['mlp-sgm-2', 128, 1e-5, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm-2', 128, 1e-5, 1.0, 10, (0.0, 1.0), 5000],
    ['mlp-sgm-2', 128, 1e-5, 0.8, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm-2', 128, 1e-5, 0.8, 10, (0.0, 1.0), 5000],
    ]

params_5 = [
    ['mlp-sgm', 128, 1e-5, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 128, 1e-5, 1.0, 10, (0.0, 1.0), 5000],
    ['mlp-sgm', 128, 1e-5, 0.8, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm', 128, 1e-5, 0.8, 10, (0.0, 1.0), 5000],
    
    ['mlp-sft', 128, 1e-5, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sft', 128, 1e-5, 1.0, 10, (0.0, 1.0), 5000],
    ['mlp-sft', 128, 1e-5, 0.8, 0,  (0.0, 1.0), 5000],
    ['mlp-sft', 128, 1e-5, 0.8, 10, (0.0, 1.0), 5000],
    
    ['mlp-sgm-2', 128, 1e-5, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm-2', 128, 1e-5, 1.0, 10, (0.0, 1.0), 5000],
    ['mlp-sgm-2', 128, 1e-5, 0.8, 0,  (0.0, 1.0), 5000],
    ['mlp-sgm-2', 128, 1e-5, 0.8, 10, (0.0, 1.0), 5000],
    
    ['mlp-sft-2', 128, 1e-5, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-sft-2', 128, 1e-5, 1.0, 10, (0.0, 1.0), 5000],
    ['mlp-sft-2', 128, 1e-5, 0.8, 0,  (0.0, 1.0), 5000],
    ['mlp-sft-2', 128, 1e-5, 0.8, 10, (0.0, 1.0), 5000]
    ]

params_6 = [
    ['mlp-relu', 128, 1e-5, 1.0, 0,  (0.0, 1.0), 5000],
    ['mlp-relu', 128, 1e-5, 1.0, 10, (0.0, 1.0), 5000],
    ['mlp-relu', 128, 1e-5, 0.8, 0,  (0.0, 1.0), 5000],
    ['mlp-relu', 128, 1e-5, 0.8, 10, (0.0, 1.0), 5000],
    ]

if __name__ == '__main__':
    ds = DataSet(4, split=[0.4, 0.1, 0.5], add_noise=2)
    test_unit_mlp(ds=ds, clf='mlp-sft', rej=2, units=128,
                  beta=0.00001, dropout=1.0, es=0, targets=(0.0, 1.0),
                  n_epochs=5000, show=True)
    
    #ds = DataSet(4, split=[0.4, 0.1, 0.5], add_noise=0)
    #test_unit_mlp(ds=ds, clf='rbf-reg', rej=0, units=64,
    #              beta=0.00001, dropout=1.0, es=0, targets=(0.0, 1.0),
    #              n_epochs=500, show=True)
    
    #test_block_mlp(4, 'segmentation', 0, range(0,1), None, [0.4, 0.1, 0.5], params_0)
    #test_block_mlp(4, 'segmentation', 0, range(0,1), None, [0.4, 0.1, 0.5], params_1)
    #test_block_mlp(4, 'segmentation', 0, range(0,1), None, [0.4, 0.1, 0.5], params_2)
    
    #test_block_rbf('segmentation', 4, range(0,1), None, [0.4, 0.1, 0.5], params_3)
    
    # test outliers rejection
    #test_block_mlp(4, 'segmentation', 1, range(0,1), None, [0.4, 0.1, 0.5], params_4)
    #test_block_mlp(4, 'segmentation', 2, range(0,1), None, [0.4, 0.1, 0.5], params_5)
    #test_block_mlp(4, 'segmentation', 2, range(0,1), None, [0.4, 0.1, 0.5], params_6)
    #test_block_mlp(4, 'segmentation', 3, range(0,1), None, [0.4, 0.1, 0.5], params_2)
    #test_block_rbf('segmentation', 4, range(0,1), None, [0.4, 0.1, 0.5], params_3)